<div class="container-fluid">
  <form
    [formGroup]="bookForm"
    autocomplete="off"
    novalidate
    (ngSubmit)="updateBook(bookForm.value)"
  >
    <div class="form-horizontal card card-body bg-light mb-2 mt-2">
      <div class="form-group row">
        <label for="title" class="control-label col-md-2">Título: </label>
        <div class="col-md-5">
          <input
            type="text"
            formControlName="title"
            id="title"
            class="form-control"
          />
        </div>
        <div class="col-md-5">
          <em *ngIf="validateControl('title') && hasError('title', 'required')"
            >O campo Título é obrigatório.</em
          >
          <em *ngIf="validateControl('title') && hasError('title', 'maxlength')"
            >Tamanho máximo permitido são 40 caractéres.</em
          >
        </div>
      </div>

      <div class="form-group row">
        <label for="company" class="control-label col-md-2">Editora: </label>
        <div class="col-md-5">
          <input
            type="text"
            formControlName="company"
            id="company"
            class="form-control"
          />
        </div>
        <div class="col-md-5">
          <em
            *ngIf="
              validateControl('company') && hasError('company', 'required')
            "
            >O campo Editora é obrigatório.</em
          >
          <em
            *ngIf="
              validateControl('company') && hasError('company', 'maxlength')
            "
            >Tamanho máximo permitido são 40 caractéres.</em
          >
        </div>
      </div>

      <div class="form-group row">
        <label for="edition" class="control-label col-md-2">Edição: </label>
        <div class="col-md-5">
          <input
            type="text"
            formControlName="edition"
            id="edition"
            class="form-control"
          />
        </div>
        <div class="col-md-5">
          <em
            *ngIf="
              validateControl('edition') && hasError('edition', 'required')
            "
            >O campo Edição é obrigatório.</em
          >
        </div>
      </div>

      <div class="form-group row">
        <label for="publishYear" class="control-label col-md-2"
          >Ano de Publicação:
        </label>
        <div class="col-md-2">
          <input
            type="text"
            formControlName="publishYear"
            id="publishYear"
            class="form-control"
          />
        </div>
        <div class="col-md-5">
          <em
            *ngIf="
              validateControl('publishYear') &&
              hasError('publishYear', 'required')
            "
            >O campo Ano de Publicação é obrigatório.</em
          >
          <em
            *ngIf="
              validateControl('publishYear') &&
              hasError('publishYear', 'maxlength')
            "
            >Tamanho máximo permitido são 4 caractéres.</em
          >
        </div>
      </div>

      <div class="form-group row">
        <label for="value" class="control-label col-md-2">Valor: </label>
        <div class="col-md-5">

          <input type="text"
            mvndrMatCurrencyFormat
            id="value"
            [allowNegative]="false"
            [currencyCode]="'BRL'"
            [value]="bookValue"
            (blur)="updateBRLAmount($event)" />

        </div>
        <div class="col-md-5">
          <em *ngIf="validateControl('value') && hasError('value', 'required')"
            >O campo Valor é obrigatório.</em
          >
        </div>
      </div>

      <div class="form-group row">
        <label for="bookAuthors" class="control-label col-md-2">Autores: </label>
        <div class="col-md-5">
          <select
            multiple
            id="bookAuthors"
            formControlName="bookAuthors"
            class="form-control"
          >
          <option *ngFor="let author of authors" [ngValue]="author.authorId" >{{author.name}}</option>
        </select>
        </div>
      </div>

      <div class="form-group row">
        <label for="bookSubjects" class="control-label col-md-2">Assunto: </label>
        <div class="col-md-5">
          <select
            multiple
            formControlName="bookSubjects"
            id="bookSubjects"
            class="form-control"
          >
          <option *ngFor="let subject of subjects" [ngValue]="subject.subjectId" >{{subject.description}}</option>
        </select>
        </div>
      </div>

      <br /><br />

      <div class="form-group row">
        <div class="offset-5 col-md-1">
          <button
            type="submit"
            class="btn btn-info"
            [disabled]="!bookForm.valid"
          >
            Salvar
          </button>
        </div>
        <div class="col-md-1">
          <button
            type="button"
            class="btn btn-danger"
            (click)="redirectToBookList()"
          >
            Cancelar
          </button>
        </div>
      </div>
    </div>
  </form>

  <app-success-modal
    [modalHeaderText]="'SUCESSO !'"
    [modalBodyText]="'Livro criado com sucesso.'"
    [okButtonText]="'OK'"
    (redirectOnOK)="redirectToBookList()"
  ></app-success-modal>

  <app-error-modal
    [modalHeaderText]="'Erro'"
    [modalBodyText]="errorMessage"
    [okButtonText]="'OK'"
  ></app-error-modal>
</div>
